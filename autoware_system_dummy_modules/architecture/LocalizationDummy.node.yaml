autoware_system_design_format: v0.1.0

name: LocalizationDummy.node

launch:
  package: autoware_system_dummy_modules
  plugin: autoware::architect_dummy_modules::Localization

# interfaces
inputs:
  - name: lanelet_map
    message_type: autoware_map_msgs/msg/LaneletMapBin
  - name: pointcloud_map
    message_type: sensor_msgs/msg/PointCloud2
  - name: pointcloud
    message_type: sensor_msgs/msg/PointCloud2
  - name: imu
    message_type: sensor_msgs/msg/Imu
  - name: twist
    message_type: geometry_msgs/msg/TwistWithCovarianceStamped
  - name: gnss_velocity
    message_type: geometry_msgs/msg/TwistWithCovarianceStamped
  - name: gnss_nav_sat_fix
    message_type: sensor_msgs/msg/NavSatFix
  - name: sub_gnss_nav_sat_fix
    message_type: sensor_msgs/msg/NavSatFix

outputs:
  - name: ros_transform
    message_type: tf2_msgs/msg/TFMessage
    global: /tf
  - name: pose_with_covariance
    message_type: geometry_msgs/msg/PoseWithCovarianceStamped
    qos:
      reliability: reliable
      durability: transient_local
  - name: acceleration
    message_type: geometry_msgs/msg/AccelWithCovarianceStamped
    qos:
      reliability: reliable
      durability: transient_local
  - name: initialization_state
    message_type: autoware_adapi_v1_msgs/msg/LocalizationInitializationState
  - name: kinematic_state
    message_type: nav_msgs/msg/Odometry
  - name: pose_estimator/pose_with_covariance
    message_type: geometry_msgs/msg/PoseWithCovarianceStamped

# parameters
parameter_files: []

parameters: []

# processes
processes:
  - name: update
    trigger_conditions:
      - or:
          - once: lanelet_map
          - on_input: pointcloud
    outcomes:
      - to_trigger: slam
  - name: slam
    trigger_conditions:
      - periodic: 100 # Hz
    outcomes:
      - to_output: ros_transform
      - to_output: pose_with_covariance
